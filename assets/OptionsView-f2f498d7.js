import{e as D,d as P,h as k,p as j,k as C,i as N,N as O,_ as x}from"./android-chrome-B-192x192-4517b689.js";import{_ as S,r as y,o as c,c as u,a as s,b as _,w as T,n as f,h as g,t as d,f as h,d as p,v as m,F as U,e as V,p as A,g as B}from"./index-b58b0c5a.js";const I={data(){return{ellipsisHorizontalOutline:D,diamondOutline:P,eyeOff:k,personSharp:j,keySharp:C,closeCircleSharp:N,selector:"account",show:null,xOffsetWatch:0,xOffsetEdit:100,height:650,showDelete:"question",userData:[],name:null,lastname:null,country:null,phone:null,date:null,url:null,description:null,password:null,newPassword:null,rNewPassword:null,msjErrorPass:"",msjErrorNewPass:"",passSuccess:!1,msjBtn:"Guardar",passwordDelete:null,msjErrorConfirm:"",confirmSuccess:!1,msjBtnDelete:"Confirmar",visiblePublications:!1,hiddens:[],showOptions:null,msjPubNull:""}},methods:{truncatedText(r){if(r)return r.slice(0,25)+(r.length>30?"...":"")},restore(r){let t={id:r.id,user:this.$store.state.user},a={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};fetch("http://localhost:5000/publication/hidden/delete",a).then(n=>{if(n.ok)return n.json();throw new Error("Error en la solicitud.")}).then(n=>{for(let e=0;e<this.hiddens.length;e++)if(this.hiddens[e].id===r.id){this.hiddens.splice(e,1);break}}).catch(n=>{console.error("Error: ",n)})},showOption(r){this.showOptions?this.showOptions!==r?this.showOptions=r:this.showOptions=null:this.showOptions=r},calculateTimeAgo(r){const t=new Date,a=new Date(r),n=t-a,e=Math.floor(n/(1e3*60));return e<60?`${e} min`:e<1440?`${Math.floor(e/60)} h`:`${Math.floor(e/1440)} d`},showPublications(){this.visiblePublications=!this.visiblePublications;const r=this.$store.state.user;fetch(`http://localhost:5000/publication/hidden/${r}`).then(t=>{if(t.ok)return t.json();if(t.stauts===400)return t.json();throw new Error("Error en la solicitud.")}).then(t=>{t&&t.message?this.msjPubNull=t.message:(this.hiddens=t.sort((a,n)=>{const e=a.fecha_creacion;return n.fecha_creacion-e}),this.hiddens.forEach(a=>{a.img_perfil="data:image/jpeg;base64,"+a.img_perfil}))}).catch(t=>{console.error("Error: ",t)})},confirmDelete(){if(this.msjErrorConfirm="",this.passwordDelete){const r=this.$store.state.user;let t={password:this.passwordDelete,user_id:this.$store.state.user_id};const a={method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};fetch(`http://localhost:5000/delete/${r}`,a).then(n=>{if(n.ok)return n.json();if(n.status===400)return n.json();throw new Error("Error en la solicitud.")}).then(n=>{n&&n.error?this.msjErrorConfirm=n.error:(this.confirmSuccess=!0,this.msjBtnDelete="Cuenta eliminada.",setTimeout(()=>{this.$store.dispatch("userLoggedOut"),this.$router.push({name:"login"})},3e3))}).catch(n=>{console.error("Error: ",n)})}else this.msjErrorConfirm="Introduzca una contraseña valida."},checkPass(){this.msjErrorNewPass="",this.msjErrorPass="";const r=this.$store.state.user;if(this.password)if(this.newPassword===this.rNewPassword)if(this.rNewPassword.length>8&&/[A-Z]/.test(this.rNewPassword)){let t={password:this.password,nueva_password:this.newPassword};const a={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};fetch(`http://localhost:5000/password/${r}`,a).then(n=>{if(n.ok)return n.json();if(n.status===400)return n.json();throw new Error("Error en la solicitud.")}).then(n=>{n&&n.error?this.msjErrorPass=n.error:(this.password="",this.newPassword="",this.rNewPassword="",this.passSuccess=!0,this.msjBtn="Contraseña actualizada!",setTimeout(()=>{this.passSuccess=!1,this.msjBtn="Guardar"},4e3))}).catch(n=>{console.error("Error: ",n)})}else this.msjErrorNewPass="La contraseña debe tener más de 8 carácteres y al menos una mayúscula.";else this.msjErrorNewPass="Las contraseñas no coinciden.";else this.msjErrorPass="Introduce la contraseña."},changeDate(){const r=this.userData.fecha_nacimiento;if(r){const t=new Date(r),a=t.getDate()+1,n=t.getMonth(),e=t.getFullYear(),b=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][n],v=`${a} de ${b} de ${e}`;this.userData.fecha_nacimiento=v}},loadUserData(r){fetch(`http://localhost:5000/profile/${r}`).then(t=>{if(t.ok)return t.json();throw new Error("Error en la solicitud")}).then(t=>{this.userData=t,this.name=this.userData.nombre,this.lastname=this.userData.apellido,this.country=this.userData.pais,this.phone=this.userData.telefono,this.date=this.userData.fecha_nacimiento,this.url=this.userData.url,this.description=this.userData.descripcion,this.changeDate()}).catch(t=>{console.error("Error: ",t)})},save(){const t=`http://localhost:5000/profile/${this.$store.state.user}`,a={nombre:this.name,apellido:this.lastname,pais:this.country,telefono:this.phone,fechaNac:this.date,url:this.url,description:this.description};let n={method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};fetch(t,n).then(e=>{if(e.ok)return e.json();throw new Error("Error en la solicitud.")}).then(e=>{this.userData=e,this.changeInfo(),this.changeDate()}).catch(e=>{console.error("Error: ",e)})},changeEdit(){this.xOffsetWatch=-105,this.xOffsetEdit=-5,this.height=800},changeInfo(){this.xOffsetWatch=0,this.xOffsetEdit=105,this.height=650},showed(r){r==="data"?this.show!=="data"?this.show="data":this.show=null:r==="info"?this.show!=="info"?this.show="info":this.show=null:this.show!=="delete"?this.show="delete":this.show=null}},mounted(){this.loadUserData(this.$store.state.user)},components:{Nav:O}},i=r=>(A("data-v-ded8c2b8"),r=r(),B(),r),M={class:"wrapper"},q={class:"container"},L={class:"logo"},z=i(()=>s("img",{src:x,alt:"imagen logo"},null,-1)),F={class:"main"},J={class:"box-config"},R={class:"section"},W=i(()=>s("h2",null,"Configuración",-1)),G=i(()=>s("h4",null,"Tu cuenta",-1)),H=[G],X=i(()=>s("h4",null,"Privacidad",-1)),Y=[X],Z={key:0,class:"config"},K=i(()=>s("h4",null,"Información de la cuenta",-1)),Q=i(()=>s("p",null,"Ve la información de tu cuenta y tus datos personales.",-1)),$=i(()=>s("div",{class:"h-form"},[s("h3",null,"Tus datos personales")],-1)),ss={key:0,class:"container-form"},es={class:"box name"},ts=i(()=>s("label",{for:"nombre"},"Nombre",-1)),os={class:"box lastname"},ns=i(()=>s("label",{for:"apellido"},"Apellido",-1)),is={class:"box country"},rs=i(()=>s("label",{for:"pais"},"País",-1)),ls={class:"box phone"},as=i(()=>s("label",{for:"telefono"},"Teléfono",-1)),cs={class:"box date"},us=i(()=>s("label",{for:"fechaNac"},"Fecha de nacimiento",-1)),ds={class:"box url"},hs=i(()=>s("label",{for:"url"},"URL",-1)),ps={class:"box description"},ms=i(()=>s("label",{for:"description"},"Descripción breve de ti",-1)),fs={class:"box button"},_s=i(()=>s("div",{class:"h-form"},[s("h3",null,"Tus nuevos datos personales")],-1)),ws={class:"container-form"},bs={class:"container-input"},vs=i(()=>s("label",{for:"nombre"},"Nombre",-1)),ys={class:"container-input"},gs=i(()=>s("label",{for:"apellido"},"Apellido",-1)),Es={class:"container-input"},Ds=i(()=>s("label",{for:"pais"},"País",-1)),Ps={class:"container-input"},ks=i(()=>s("label",{for:"telefono"},"Teléfono",-1)),js={class:"container-input"},Cs=i(()=>s("label",{for:"fechaNac"},"Fecha de nacimiento",-1)),Ns={class:"container-input"},Os=i(()=>s("label",{for:"url"},"URL",-1)),xs={class:"container-input"},Ss=i(()=>s("label",{for:"description"},"Descripción breve de ti",-1)),Ts={class:"container-buttons"},Us=i(()=>s("h4",null,"Cambia tu contraseña",-1)),Vs=i(()=>s("p",null,"Cambia tu contraseña en cualquier momento.",-1)),As={key:1,class:"pass"},Bs={class:"container-input"},Is=i(()=>s("label",{for:"pass"},"Contraseña actual",-1)),Ms={key:0,class:"msjError"},qs={class:"container-input"},Ls=i(()=>s("label",{for:"newPass"},"Nueva contraseña",-1)),zs={class:"container-input"},Fs=i(()=>s("label",{for:"rNewPass"},"Repita la nueva contraseña",-1)),Js={key:0,class:"msjError"},Rs={class:"container-buttons"},Ws=i(()=>s("h4",null,"Elimina tu cuenta",-1)),Gs=i(()=>s("p",null,"Averigua cómo puedes eleminar tu cuenta.",-1)),Hs={key:2,class:"delete"},Xs={key:0,class:"container-deleted"},Ys=i(()=>s("h4",null,"Deseas eliminar tu cuenta?",-1)),Zs={key:1,class:"container-confirm"},Ks=i(()=>s("p",null,"Si realmente quieres eliminar tu cuenta, introduce tu contraseña",-1)),Qs={key:0,class:"msjError"},$s={key:1,class:"config two"},se=i(()=>s("h4",null,"Publicaciones ocultas",-1)),ee=i(()=>s("p",null,"Mira y elige si deseas volver a ver algunas publicaciones ocultas.",-1)),te={key:0,class:"box-publications"},oe={class:"options"},ne=["onClick"],ie={class:"img-publ normal"},re=["src"],le={class:"data-publ"},ae={key:0,class:"img-post"},ce=["src"],ue={class:"ups"},de={key:0,class:"publication msj"};function he(r,t,a,n,e,l){const b=y("Nav"),v=y("router-link"),w=y("ion-icon");return c(),u("div",M,[s("div",q,[_(b),s("div",L,[_(v,{to:{name:"home"}},{default:T(()=>[z]),_:1})]),s("main",F,[s("div",J,[s("div",R,[W,s("div",{class:f(["personalData",{actived:e.selector==="account"}]),onClick:t[0]||(t[0]=o=>e.selector="account")},H,2),s("div",{class:f(["privacity",{actived:e.selector==="privacity"}]),onClick:t[1]||(t[1]=o=>e.selector="privacity")},Y,2)]),e.selector==="account"?(c(),u("div",Z,[s("div",{class:f(["your-account",{activedOptions:e.show==="data"}]),onClick:t[2]||(t[2]=o=>l.showed("data"))},[_(w,{src:e.personSharp},null,8,["src"]),K,Q],2),e.show==="data"?(c(),u("div",{key:0,class:"data",style:g({height:e.height+"px"})},[s("div",{class:"personal-data info",style:g({transform:"translateX("+e.xOffsetWatch+"%)"})},[$,e.userData!==null?(c(),u("div",ss,[s("form",null,[s("div",es,[ts,s("span",null,d(e.userData.nombre),1)]),s("div",os,[ns,s("span",null,d(e.userData.apellido),1)]),s("div",is,[rs,s("span",null,d(e.userData.pais),1)]),s("div",ls,[as,s("span",null,d(e.userData.telefono),1)]),s("div",cs,[us,s("span",null,d(e.userData.fecha_nacimiento),1)]),s("div",ds,[hs,s("span",null,d(l.truncatedText(e.userData.url)),1)]),s("div",ps,[ms,s("span",null,d(l.truncatedText(e.userData.descripcion)),1)]),s("div",fs,[s("button",{type:"button",class:"btn",onClick:t[3]||(t[3]=(...o)=>l.changeEdit&&l.changeEdit(...o))},"Editar")])])])):h("",!0)],4),s("div",{class:"personal-data form",style:g({transform:"translateX("+e.xOffsetEdit+"%)"})},[_s,s("div",ws,[s("form",null,[s("div",bs,[vs,p(s("input",{type:"text",name:"nombre",required:"","onUpdate:modelValue":t[4]||(t[4]=o=>e.name=o)},null,512),[[m,e.name]])]),s("div",ys,[gs,p(s("input",{type:"text",name:"apellido",required:"","onUpdate:modelValue":t[5]||(t[5]=o=>e.lastname=o)},null,512),[[m,e.lastname]])]),s("div",Es,[Ds,p(s("input",{type:"text",name:"pais",required:"","onUpdate:modelValue":t[6]||(t[6]=o=>e.country=o)},null,512),[[m,e.country]])]),s("div",Ps,[ks,p(s("input",{type:"text",name:"telefono",required:"","onUpdate:modelValue":t[7]||(t[7]=o=>e.phone=o)},null,512),[[m,e.phone]])]),s("div",js,[Cs,p(s("input",{type:"date",name:"fechaNac",required:"","onUpdate:modelValue":t[8]||(t[8]=o=>e.date=o)},null,512),[[m,e.date]])]),s("div",Ns,[Os,p(s("input",{type:"url",name:"url",id:"url","onUpdate:modelValue":t[9]||(t[9]=o=>e.url=o)},null,512),[[m,e.url]])]),s("div",xs,[Ss,p(s("textarea",{name:"descripition",id:"descripition",cols:"30",rows:"3","onUpdate:modelValue":t[10]||(t[10]=o=>e.description=o)},null,512),[[m,e.description]])]),s("div",Ts,[s("button",{type:"button",class:"btn",onClick:t[11]||(t[11]=(...o)=>l.changeInfo&&l.changeInfo(...o))},"Cancelar"),s("button",{type:"button",class:"btn",onClick:t[12]||(t[12]=(...o)=>l.save&&l.save(...o))},"Guardar")])])])],4)],4)):h("",!0),s("div",{class:f(["change-password",{activedOptions:e.show==="info"}]),onClick:t[13]||(t[13]=o=>l.showed("info"))},[_(w,{src:e.keySharp},null,8,["src"]),Us,Vs],2),e.show==="info"?(c(),u("div",As,[s("div",Bs,[Is,p(s("input",{type:"password",name:"pass",id:"pass","onUpdate:modelValue":t[14]||(t[14]=o=>e.password=o)},null,512),[[m,e.password]]),e.msjErrorPass?(c(),u("p",Ms,d(e.msjErrorPass),1)):h("",!0)]),s("div",qs,[Ls,p(s("input",{type:"password",name:"newPass",id:"newPass","onUpdate:modelValue":t[15]||(t[15]=o=>e.newPassword=o)},null,512),[[m,e.newPassword]])]),s("div",zs,[Fs,p(s("input",{type:"password",name:"rNewPass",id:"rNewPass","onUpdate:modelValue":t[16]||(t[16]=o=>e.rNewPassword=o)},null,512),[[m,e.rNewPassword]]),e.msjErrorNewPass?(c(),u("p",Js,d(e.msjErrorNewPass),1)):h("",!0)]),s("div",Rs,[s("button",{type:"button",class:f(["btn",{success:e.passSuccess}]),onClick:t[17]||(t[17]=(...o)=>l.checkPass&&l.checkPass(...o))},d(e.msjBtn),3)])])):h("",!0),s("div",{class:f(["delete-account",{activedOptions:e.show==="delete"}]),onClick:t[18]||(t[18]=o=>l.showed("delete"))},[_(w,{src:e.closeCircleSharp},null,8,["src"]),Ws,Gs],2),e.show==="delete"?(c(),u("div",Hs,[e.showDelete=="question"?(c(),u("div",Xs,[Ys,s("button",{type:"button",class:"btn",onClick:t[19]||(t[19]=o=>e.showDelete="confirm")},"Eliminar")])):e.showDelete=="confirm"?(c(),u("div",Zs,[Ks,p(s("input",{type:"password",name:"pass",id:"pass","onUpdate:modelValue":t[20]||(t[20]=o=>e.passwordDelete=o)},null,512),[[m,e.passwordDelete]]),e.msjErrorConfirm?(c(),u("p",Qs,d(e.msjErrorConfirm),1)):h("",!0),s("button",{type:"button",class:f(["btn",{success:e.confirmSuccess}]),onClick:t[21]||(t[21]=(...o)=>l.confirmDelete&&l.confirmDelete(...o))},d(e.msjBtnDelete),3)])):h("",!0)])):h("",!0)])):(c(),u("div",$s,[s("div",{class:f(["hidden-publications",{activedOptions:e.visiblePublications}]),onClick:t[22]||(t[22]=(...o)=>l.showPublications&&l.showPublications(...o))},[_(w,{src:e.eyeOff},null,8,["src"]),se,ee],2)]))]),e.visiblePublications&&e.selector==="privacity"?(c(),u("div",te,[(c(!0),u(U,null,V(e.hiddens,o=>(c(),u("div",{class:"publication",key:o.id},[s("div",oe,[s("p",null,d(l.calculateTimeAgo(o.fecha_creacion)),1),_(w,{src:e.ellipsisHorizontalOutline,onClick:E=>l.showOption(o.id)},null,8,["src","onClick"]),s("span",{class:f({visible:e.showOptions===o.id}),onClick:E=>l.restore(o)},"Restaurar",10,ne)]),s("div",ie,[s("img",{src:o.img_perfil,alt:"imagen perfil"},null,8,re),s("div",le,[s("h3",null,d(o.user_id),1),s("p",null,d(o.contenido),1)])]),o.imagen?(c(),u("div",ae,[s("img",{src:"data:image/jpeg;base64,"+o.imagen,alt:"Imagen"},null,8,ce)])):h("",!0),s("div",ue,[s("span",null,d(o.likes),1),_(w,{src:e.diamondOutline},null,8,["src"])])]))),128)),e.msjPubNull?(c(),u("div",de,[s("p",null,d(e.msjPubNull),1)])):h("",!0)])):h("",!0)])])])}const fe=S(I,[["render",he],["__scopeId","data-v-ded8c2b8"]]);export{fe as default};
